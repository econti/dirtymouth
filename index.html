
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<link href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div style="max-width:800px">
    <a id="login" class='btn btn-large btn-success'>HOW DIRTY AM I</a>
  </div>
</body>
<script>

  var FB = null;
  var messages;
  var words;

  window.fbAsyncInit = function() {
    // init the FB JS SDK
    FB.init({
      appId      : '501949316569863',                        // App ID from the app dashboard
      channelUrl : 'http://localhost/channel.html', // Channel file for x-domain comms
      status     : true,                                 // Check Facebook Login status
      xfbml      : true,                                 // Look for social plugins on the page
      cookie      :true
    });

          FB.Event.subscribe("auth.login", function (a) {
            processLogin(a)
        });
        FB.Event.subscribe("auth.authResponseChange", function (a) {
            processLogin(a)
        });
        FB.Event.subscribe("auth.statusChange", function (a) {
            processLogin(a)
        });
        FB.Event.subscribe("auth.logout", function (b) {
            processLogin()
        })

        processLogin();
  };
//herpy derp
  // Load the SDK asynchronously

  $("#login").click(function(){
    hasLogin();
  });

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "https://connect.facebook.net/en_US/all.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
  
function getData(d) {
    var b = 100;
    var a = 6;
    for (var c = 0; c < a; c++) {
        needLoadCount++;
        FB.api(d + "&limit=" + b + "&offset=" + b * c, function (f) {
            doneLoadCount++;
            if (doneLoadCount == needLoadCount && loading) {
                genWrap()
            }
            if (f.error) {
                console.log(d, f.error.message);
                return
            }
            if (!f || !f.data || !f.data.length) {
                return
            }
            var i = f.data;
            for (j = 0; j < i.length; j++) {
                var g = i[j];
                if (!g.from || g.from.id == myUID) {
                    var h = g.message;
                    if (!h) {
                        h = g.name
                    }
                    if (h) {
                        addMessage(h)
                    }
                }
                var l = g.comments;
                if (!l || !l.data || !l.data.length) {
                    continue
                }
                for (var e = 0; e < l.data.length; e++) {
                    var m = l.data[e];
                    if (m.from && m.from.id == myUID && m.message) {
                        addMessage(m.message)
                    }
                }
            }
        })
    }
}

function genWrap() {
    if (!messages.length) {
        if (loading) {
            alert("Please wait until messages are loaded")
        } else {
            alert("No messages found")
        }
        return
    }
    stopLoading();
    words = countWordsInSentences(messages);
}

function countWordsInSentences(messages) {
  var words = {};
  for(var i in messages) {
    var ws = messages[i].split(" ");
    for (var i in ws) {
      var w = ws[i].toLowerCase().replace(/[^a-z]/g,"");
      if (w.length > 0) {
        if (words[w]) {
          words[w]++;
        } else {
          words[w] = 1;
        }
      }
    }
  } 
  return words;
}

function addMessage(a) {
    if (messages.length > 1000) {
        return
    }
    messages.push(a);
    if (messages.length == 200) {
        genWrap()
    }
  }
  function startLoading() {
    loading = true;
    $("#loader").show();
}

    function resetData() {
    messages = [];
    words = {};
    needLoadCount = 0;
    doneLoadCount = 0;
    startLoading()
}


function loadData() {
    resetData();
    getData("/me/posts?fields=message,comments.fields(from,message)");
    getData("/me/feed?fields=from,message,comments.fields(from,message)");
    getData("/me/statuses?fields=message,comments.fields(from,message)");
    getData("/me/links?fields=message,comments.fields(from,message)");
    getData("/me/checkins?fields=message,comments.fields(from,message)");
    getData("/me/photos?fields=from,name,comments.fields(from,message)")
}

function processLogin(a) {
    if (a && a.status == "connected") {
        $("#btn-login").hide();
        $("#btn-logout").show();
        if (!myUID) {
            loadData()
        }
        myUID = a.authResponse.userID
    } else {
        myUID = 0;
        $("#btn-login").show();
        $("#btn-logout").hide()
    }
}

function hasLogin() {
    if (!myUID) {
        FB.login(function (a) {
            processLogin(a)
        }, {
            scope: "user_status,user_photos"
        });
        return false
    }
    return true
}

function stopLoading() {
    loading = false;
    $("#loading").slideUp(500)
}

function fbLogoutUser() {
    FB.getLoginStatus(function(response) {
        if (response && response.status === 'connected') {
            FB.logout(function(response) {
                location.reload();
            });
        }
    });
}
</script>
